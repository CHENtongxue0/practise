<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itheima.mapper.EmpMapper">
<!--    <insert>执行插入sql语句的标签命令-->
<!--    useGeneratedKeys="true" 获取生成的自增长主键值-->
<!--    keyProperty="id" 将主键值设置给参数对象里面id属性-->

    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        insert into emp values(
                                  null,#{username},#{password},#{name},
                                  #{gender},#{phone},#{job},#{salary},
                                  #{image},#{entryDate},#{deptId},#{createTime},
                                  #{updateTime}
                              )
    </insert>


    <select id="getCount" resultType="Long">
        select count(*)
        from emp e
        left join dept d on e.dept_id = d.id
        <where>
            <if test="name!=null and name!=''">
                e.name like concat('%',#{name},'%')
            </if>
            <if test="gender!=null and gender!=''">
                and e.gender = #{gender}
            </if>
            <if test="begin!=null and end!=null">
                and e.entry_date between #{begin} and #{end}
            </if>
        </where>
    </select>


    <!--
    映射
     Long getByPageList(String name, Integer gender,
                  LocalDate begin,LocalDate end,Integer start,Integer length);
    -->
    <select id="getByPageList" resultType="com.itheima.pojo.Emp">
        select e.*,d.name deptName
        from emp e
        left join dept d on e.dept_id = d.id
        <where>
            <if test="name!=null and name!=''">
                e.name like concat('%',#{name},'%')
            </if>
            <if test="gender!=null">
                and e.gender = #{gender}
            </if>
            <if test="begin!=null and end!=null">
                and e.entry_date between #{begin} and #{end}
            </if>
        </where>
        limit #{start},#{length}
    </select>

    <select id="findByPage" resultType="com.itheima.pojo.Emp">
        select e.*,d.name deptName
        from emp e
        left join dept d on e.dept_id = d.id
        <where>
            <if test="name!=null and name!=''">
                e.name like concat('%',#{name},'%')
            </if>
            <if test="gender!=null">
                and e.gender = #{gender}
            </if>
            <if test="begin!=null and end!=null">
                and e.entry_date between #{begin} and #{end}
            </if>
        </where>
    </select>
</mapper>
